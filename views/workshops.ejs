<!-- HERO -->
<section class="hero" id="hero">
    <div class="hero-content">
        <img src="/assets/logo-icon.png" alt="Rabuste Coffee Logo" class="hero-logo" style="display:block; margin:0 auto 20px auto; width:120px;">
        <h1 class="hero-title">Workshops At Rabuste</h1>
        <p class="hero-subtitle">Where Creativity Meets Caffeine</p>
    </div>
    <div class="particles"></div>
</section>

<!-- INTRO CARD -->
<section class="intro">
  <div class="intro-card">
    <h2>About Workshops at Rabuste</h2>
    <p>
      Workshops at Rabuste are intimate, hands-on creative sessions curated
      around art, coffee, and mindful making. Each workshop is designed to
      bring people together ‚Äî to learn, create, and slow down over coffee.
    </p>

    <p class="intro-muted">
      From coffee brewing and latte art to printmaking and illustration,
      every session is guided by experienced artists and creators.
    </p>

    <a href="#upcoming" class="intro-btn">Explore Upcoming Workshops</a>
  </div>
</section>



<section class="why-register">
  <div class="why-card">

    <h2>What Makes a Rabuste Workshop Special</h2>
    <p class="why-subtitle">
      Thoughtfully curated sessions where creativity, coffee, and community meet.
    </p>

    <div class="why-grid">

      <!-- 1. Workshop Previews -->
      <div class="why-mini">
        <h3>Workshop Previews</h3>
        <p>
          A rotating mix of art, craft, and coffee-focused sessions designed to
          help you slow down and create intentionally.
        </p>
      </div>

      <!-- 2. Next Workshop Highlight -->
      <div class="why-mini highlight">
        <h3>Next Workshop</h3>
        <% if (typeof upcomingWorkshops !== 'undefined' && upcomingWorkshops.length > 0) { %>
          <p class="highlight-title"><%= upcomingWorkshops[0].title %></p>
          <span class="highlight-date"><%= new Date(upcomingWorkshops[0].date).toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' }) %></span>
          <p class="highlight-note">
            Our closest upcoming session ‚Äî limited seats available.
          </p>
        <% } else { %>
          <p class="highlight-title">No Upcoming Workshops</p>
          <span class="highlight-date">Stay Tuned</span>
          <p class="highlight-note">
            New workshops coming soon. Check back later!
          </p>
        <% } %>
      </div>

      <!-- 3. Who It's For -->
      <div class="why-mini">
        <h3>Who It's For</h3>
        <p>
          Curious beginners, creative explorers, coffee lovers, and anyone
          looking for a calm, hands-on experience.
        </p>
      </div>

      <!-- 4. What You'll Take Home -->
      <div class="why-mini">
        <h3>What You'll Take Home</h3>
        <p>
          New skills, something you've made with your hands, and a slower,
          more mindful memory of the day.
        </p>
      </div>

    </div>

  </div>
</section>


<!-- UPCOMING WORKSHOP -->
<!-- UPCOMING -->
<section id="upcoming">
  <h2>Upcoming Workshops</h2>

  <div class="grid upcoming-grid">
    <% if (typeof upcomingWorkshops !== 'undefined' && upcomingWorkshops.length > 0) { %>
      <% upcomingWorkshops.forEach(workshop => { %>
        <!-- <%= workshop.title %> -->
        <div class="workshop-card" data-workshop-id="<%= workshop._id || workshop.id || '' %>">
          <div class="workshop-img">
            <img src="<%= workshop.image || 'https://images.unsplash.com/photo-1509042239860-f550ce710b93' %>"
                 alt="<%= workshop.title %>">
          </div>

          <div class="workshop-content">
            <h3><%= workshop.title %></h3>
            <div class="meta">üìÖ <%= new Date(workshop.date).toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' }) %></div>
            <% if (workshop.meta && workshop.meta.duration) { %>
              <div class="meta">‚è±Ô∏è <%= workshop.meta.duration %></div>
            <% } %>
            <% if (workshop.meta && workshop.meta.level) { %>
              <div class="meta">üìä <%= workshop.meta.level %></div>
            <% } %>
            <div class="countdown" data-date="<%= workshop.date %>"></div>
            <p class="workshop-description"><%= workshop.description || '' %></p>

            <% 
              // Ensure workshop ID is properly set
              let workshopId = '';
              if (workshop._id && workshop._id !== 'undefined' && workshop._id !== 'null') {
                workshopId = String(workshop._id).trim();
              } else if (workshop.id && workshop.id !== 'undefined' && workshop.id !== 'null') {
                workshopId = String(workshop.id).trim();
              }
              
              // Validate workshopId is not empty
              if (!workshopId || workshopId === '' || workshopId === 'undefined' || workshopId === 'null') {
                console.error('Workshop missing valid ID:', {
                  title: workshop.title,
                  _id: workshop._id,
                  id: workshop.id,
                  hasId: !!workshop._id,
                  hasIdField: !!workshop.id
                });
              }
            %>
            <button class="register-btn"
              data-workshop-id="<%= workshopId %>"
              data-workshop-title="<%= workshop.title.replace(/"/g, '&quot;') %>"
              data-workshop-date="<%= new Date(workshop.date).toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' }) %>"
              onclick="handleRegisterClick(this)"
              <%= !workshopId ? 'disabled title="Workshop ID missing - cannot register"' : '' %>>
              Register
            </button>
          </div>
        </div>
      <% }); %>
    <% } else { %>
      <div class="no-workshops">
        <p>No upcoming workshops at the moment. Check back soon!</p>
      </div>
    <% } %>
  </div>
</section>

<!-- PAST -->
<section id="past">
  <h2>Past Workshops</h2>

  <div class="grid">
    <% if (typeof pastWorkshops !== 'undefined' && pastWorkshops.length > 0) { %>
      <% pastWorkshops.forEach(workshop => { %>
        <!-- <%= workshop.title %> -->
        <div class="card clickable"
          onclick="openGallery(<%= JSON.stringify(workshop.galleryImages || []) %>)">
          <img src="<%= workshop.image || 'https://images.unsplash.com/photo-1509042239860-f550ce710b93' %>" alt="<%= workshop.title %>">

          <div class="card-content">
            <h3><%= workshop.title %></h3>

            <div class="meta">
              <% if (workshop.meta && workshop.meta.tags && workshop.meta.tags.length > 0) { %>
                <span class="meta-item">
                  <% if (workshop.category === 'Coffee' || workshop.category === 'Coffee Education') { %>‚òï<% } 
                     else if (workshop.category === 'Art') { %>üé®<% } 
                     else if (workshop.category === 'Clay Modelling') { %>ü™î<% } 
                     else { %>üñ®Ô∏è<% } %> 
                  <%= workshop.meta.tags[0] %>
                </span>
                <span class="dot">¬∑</span>
                <span class="meta-item"><%= workshop.meta.level || 'All Levels' %></span>
              <% } else { %>
                <span class="meta-item">
                  <% if (workshop.category === 'Coffee' || workshop.category === 'Coffee Education') { %>‚òï Coffee<% } 
                     else if (workshop.category === 'Art') { %>üé® Art<% } 
                     else if (workshop.category === 'Clay Modelling') { %>ü™î Clay Modelling<% } 
                     else { %>üñ®Ô∏è Workshop<% } %>
                </span>
                <span class="dot">¬∑</span>
                <span class="meta-item">Hands-on</span>
              <% } %>
            </div>

            <p class="card-desc">
              <%= workshop.description || 'A creative workshop experience at Rabuste Coffee.' %>
            </p>
          </div>
        </div>
      <% }); %>
    <% } else { %>
      <div class="no-workshops">
        <p>No past workshops to display yet.</p>
      </div>
    <% } %>
  </div>
</section>


<section class="community-signup">

  <div class="community-grid">

    <!-- LEFT : COMMUNITY -->
    <div class="community-left">
      <h2>Our Community</h2>

      <p class="community-text">
        More than workshops, these are shared afternoons.
        Moments of slowing down, creating together,
        and feeling at home in a space filled with warmth.
      </p>

      <div class="community-images">
        <img src="https://images.unsplash.com/photo-1511920170033-f8396924c348" alt="Coffee moment">
        <img src="https://images.unsplash.com/photo-1504754524776-8f4f37790ca0" alt="Creative space">
      </div>

      <p class="community-quote">
        "More than workshops, these are shared afternoons."
      </p>
    </div>

    <!-- GOLD DIVIDER -->
    <div class="gold-divider"></div>

    <!-- RIGHT : ORGANIZE WORKSHOP -->
    <div class="community-right">
      <h2>Organize Your Workshop</h2>

      <p class="community-text">
        Have an idea for a creative workshop? Share your vision with us
        and let's bring it to life at Rabuste.
      </p>

      <button class="organize-btn" onclick="openOrganizeModal()">
        <i class="fas fa-plus-circle"></i>
        Propose Workshop
      </button>

      <p class="organize-note">
        Submit your workshop idea and we'll help you make it happen.
        Perfect for artists, creators, and coffee enthusiasts.
      </p>
    </div>

  </div>

</section>


<!-- REGISTRATION MODAL -->
<div class="modal" id="registerModal" onclick="closeRegister()">
  <div class="modal-content form-modal" onclick="event.stopPropagation()">
    <div class="modal-header">
      <h3><i class="fas fa-calendar-check"></i> Workshop Registration</h3>
      <button class="close-btn" onclick="closeRegister()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <form id="registerForm">
      <input type="hidden" id="workshopId" name="workshopId">
      <input id="workshopName" placeholder="Workshop Name" readonly>
      <input id="workshopDate" placeholder="Workshop Date" readonly>

      <div class="form-group">
        <label for="participantName">Your Name *</label>
        <input id="participantName" name="name" placeholder="Enter your full name" required>
      </div>

      <div class="form-group">
        <label for="participantEmail">Email Address *</label>
        <input id="participantEmail" name="email" type="email" placeholder="your.email@example.com" required>
      </div>

      <div class="form-group">
        <label for="participantPhone">Phone Number *</label>
        <input id="participantPhone" name="phone" type="tel" placeholder="+91 9876543210" required>
      </div>

      <button type="submit" class="submit-btn">
        <i class="fas fa-check"></i>
        Confirm Registration
      </button>
    </form>
  </div>
</div>

<!-- ORGANIZE WORKSHOP MODAL -->
<div class="modal" id="organizeModal" onclick="closeOrganizeModal()">
  <div class="modal-content organize-modal" onclick="event.stopPropagation()">
    <div class="modal-header">
      <h3><i class="fas fa-calendar-plus"></i> Propose Your Workshop</h3>
      <button class="close-btn" onclick="closeOrganizeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <form class="workshop-organize-form" id="organizeWorkshopForm">
      <!-- Basic Information -->
      <div class="form-section">
        <h4><i class="fas fa-info-circle"></i> Workshop Details</h4>
        
        <div class="form-group">
          <input type="text" id="proposedTitle" placeholder="Workshop Title *" required>
        </div>
        
        <div class="form-group">
          <select id="proposedCategory" required>
            <option value="">Select Category *</option>
            <option value="coffee">‚òï Coffee & Brewing</option>
            <option value="art">üé® Visual Arts</option>
            <option value="craft">‚úÇÔ∏è Crafts & Making</option>
            <option value="wellness">üßò Wellness & Mindfulness</option>
            <option value="culinary">üç≥ Culinary Arts</option>
            <option value="music">üéµ Music & Performance</option>
            <option value="writing">‚úçÔ∏è Writing & Literature</option>
            <option value="photography">üì∏ Photography</option>
            <option value="other">üîß Other</option>
          </select>
        </div>
        
        <div class="form-group">
          <textarea id="proposedDescription" placeholder="Describe your workshop idea, what participants will learn, and what makes it special... *" rows="3" required></textarea>
        </div>
      </div>

      <!-- Organizer Information -->
      <div class="form-section">
        <h4><i class="fas fa-user"></i> About You</h4>
        
        <div class="form-row">
          <div class="form-group">
            <input type="text" id="organizerName" placeholder="Your Name *" required>
          </div>
          <div class="form-group">
            <input type="email" id="organizerEmail" placeholder="Email Address *" required>
          </div>
        </div>
        
        <div class="form-group">
          <input type="tel" id="organizerPhone" placeholder="Phone Number">
        </div>
        
        <div class="form-group">
          <textarea id="organizerExperience" placeholder="Tell us about your experience and qualifications..." rows="2"></textarea>
        </div>
      </div>

      <!-- Workshop Logistics -->
      <div class="form-section">
        <h4><i class="fas fa-cogs"></i> Workshop Details</h4>
        
        <div class="form-row">
          <div class="form-group">
            <input type="number" id="proposedDuration" placeholder="Duration (hours) *" min="1" max="8" step="0.5" required>
          </div>
          <div class="form-group">
            <input type="number" id="proposedCapacity" placeholder="Max Participants *" min="1" max="30" required>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <select id="proposedSkillLevel">
              <option value="">Skill Level</option>
              <option value="beginner">Beginner Friendly</option>
              <option value="intermediate">Intermediate</option>
              <option value="advanced">Advanced</option>
              <option value="all-levels">All Levels</option>
            </select>
          </div>
          <div class="form-group">
            <input type="number" id="proposedPrice" placeholder="Suggested Price (‚Çπ)" min="0" step="5">
          </div>
        </div>
        
        <div class="form-group">
          <input type="date" id="preferredDate" placeholder="Preferred Date">
        </div>
      </div>

      <!-- Additional Information -->
      <div class="form-section">
        <h4><i class="fas fa-plus-circle"></i> Additional Info</h4>
        
        <div class="form-group">
          <textarea id="materialsNeeded" placeholder="What materials or equipment will you need?" rows="2"></textarea>
        </div>
        
        <div class="form-group">
          <select id="collaborationType">
            <option value="">How would you like to collaborate?</option>
            <option value="lead-solo">Lead independently</option>
            <option value="co-facilitate">Co-facilitate with team</option>
            <option value="guest-instructor">Guest instructor</option>
            <option value="one-time">One-time workshop</option>
            <option value="series">Workshop series</option>
          </select>
        </div>
        
        <div class="form-group">
          <textarea id="additionalNotes" placeholder="Any additional notes or special requirements?" rows="2"></textarea>
        </div>
      </div>

      <button type="submit" class="submit-btn">
        <i class="fas fa-paper-plane"></i>
        Submit Proposal
      </button>
    </form>
  </div>
</div>

<!-- GALLERY MODAL -->
<div class="modal" id="galleryModal" onclick="closeGallery()">
  <div class="modal-content gallery" id="galleryContent"
       onclick="event.stopPropagation()">
  </div>
</div>