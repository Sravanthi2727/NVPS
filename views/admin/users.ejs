<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <meta name="description" content="<%= description %>">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <%- additionalCSS %>
    
    <style>
        /* Complete CSS Reset for Admin */
        * {
            margin: 0 !important;
            padding: 0 !important;
            box-sizing: border-box !important;
        }
        
        html, body {
            margin: 0 !important;
            padding: 0 !important;
            font-family: 'Inter', sans-serif !important;
            background: #000 !important;
            color: #f5f2ee !important;
            height: 100% !important;
        }
        
        /* Admin Container */
        .admin-container {
            min-height: 100vh !important;
            background: #000 !important;
            padding: 2rem !important;
        }
        
        /* Admin Header */
        .admin-header {
            background: linear-gradient(135deg, #1a1a1a, #2a2a2a) !important;
            border-radius: 15px !important;
            padding: 2rem !important;
            margin-bottom: 2rem !important;
            border: 1px solid #333 !important;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3) !important;
        }
        
        .admin-header h1 {
            color: #f5f2ee !important;
            font-weight: 700 !important;
            margin-bottom: 0.5rem !important;
        }
        
        .admin-header .text-muted {
            color: rgba(245, 242, 238, 0.7) !important;
        }
        
        /* Admin Filters */
        .admin-filters {
            background: #1a1a1a !important;
            border-radius: 10px !important;
            padding: 1.5rem !important;
            margin-bottom: 2rem !important;
            border: 1px solid #333 !important;
        }
        
        /* Admin Section */
        .admin-section {
            background: #1a1a1a !important;
            border-radius: 15px !important;
            padding: 2rem !important;
            margin-bottom: 2rem !important;
            border: 1px solid #333 !important;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3) !important;
        }
        
        /* Table Styles */
        .admin-table-container {
            overflow-x: auto !important;
        }
        
        .admin-table {
            width: 100% !important;
            background: #1a1a1a !important;
            border-radius: 10px !important;
            overflow: hidden !important;
        }
        
        .admin-table thead th {
            background: #1a1a1a !important;
            color: #f5f2ee !important;
            font-weight: 600 !important;
            padding: 1rem !important;
            border-bottom: 1px solid #333 !important;
        }
        
        .admin-table tbody td {
            padding: 1rem !important;
            border-bottom: 1px solid #333 !important;
            color: #1a1a1a !important;
        }
        
        .admin-table tbody tr:hover {
            background: #2a2a2a !important;
        }
        
        /* User Info */
        .user-info {
            display: flex !important;
            align-items: center !important;
            gap: 0.75rem !important;
        }
        
        .user-avatar {
            width: 40px !important;
            height: 40px !important;
            border-radius: 50% !important;
            background: #d6a45a !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            color: #000 !important;
            font-weight: 600 !important;
            font-size: 1.1rem !important;
        }
        
        .user-avatar-large {
            width: 60px !important;
            height: 60px !important;
            border-radius: 50% !important;
            background: #d6a45a !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            color: #000 !important;
            font-weight: 600 !important;
            font-size: 1.5rem !important;
            margin: 0 auto 1rem !important;
        }
        
        /* Buttons */
        .btn {
            border-radius: 8px !important;
            font-weight: 500 !important;
            transition: all 0.3s ease !important;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #d6a45a, #e3b873) !important;
            border: none !important;
            color: #000 !important;
        }
        
        .btn-outline-secondary {
            border-color: #6c757d !important;
            color: #6c757d !important;
        }
        
        .btn-outline-secondary:hover {
            background: #6c757d !important;
            color: #fff !important;
        }
        
        .btn-outline-primary {
            border-color: #007bff !important;
            color: #007bff !important;
        }
        
        .btn-outline-warning {
            border-color: #ffc107 !important;
            color: #ffc107 !important;
        }
        
        .btn-outline-success {
            border-color: #28a745 !important;
            color: #28a745 !important;
        }
        
        /* Badges */
        .badge {
            font-size: 0.75rem !important;
            padding: 0.375rem 0.75rem !important;
            border-radius: 20px !important;
        }
        
        .badge.bg-success {
            background: #28a745 !important;
        }
        
        .badge.bg-primary {
            background: #d6a45a !important;
            color: #000 !important;
        }
        
        .badge.bg-warning {
            background: #ffc107 !important;
            color: #000 !important;
        }
        
        .badge.bg-danger {
            background: #dc3545 !important;
        }
        
        .badge.bg-secondary {
            background: #6c757d !important;
        }
        
        /* Modal Styles */
        .modal-content {
            background: #1a1a1a !important;
            color: #f5f2ee !important;
            border: 1px solid #333 !important;
        }
        
        .modal-header {
            border-bottom: 1px solid #333 !important;
        }
        
        .modal-footer {
            border-top: 1px solid #333 !important;
        }
        
        .form-control {
            background: #1a1a1a !important;
            border: 1px solid #333 !important;
            color: #f5f2ee !important;
            border-radius: 8px !important;
        }
        
        .form-control:focus {
            background: #1a1a1a !important;
            border-color: #d6a45a !important;
            color: #f5f2ee !important;
            box-shadow: 0 0 0 0.2rem rgba(214, 164, 90, 0.25) !important;
        }
        
        .form-select {
            background: #1a1a1a !important;
            border: 1px solid #333 !important;
            color: #f5f2ee !important;
            border-radius: 8px !important;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .admin-container {
                padding: 1rem !important;
            }
            
            .admin-header, .admin-section {
                padding: 1rem !important;
            }
            
            .user-info {
                flex-direction: column !important;
                text-align: center !important;
            }
        }
    </style>
</head>
<body>
<!-- User Management -->
<div class="admin-container">
  <div class="admin-header">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h1>User Management</h1>
        <p class="text-muted">Manage user accounts, roles, and permissions</p>
      </div>
      <div>
        <button class="btn btn-success me-2" onclick="showAddUserModal()">
          <i class="fas fa-plus"></i> Add User
        </button>
        <a href="/admin" class="btn btn-outline-secondary">
          <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
      </div>
    </div>
  </div>

  <!-- Filter and Search -->
  <div class="admin-filters">
    <div class="row g-3">
      <div class="col-md-3">
        <select class="form-select" id="roleFilter">
          <option value="">All Roles</option>
          <option value="admin">Admin</option>
          <option value="customer">Customer</option>
          <option value="staff">Staff</option>
        </select>
      </div>
      <div class="col-md-3">
        <select class="form-select" id="statusFilter">
          <option value="">All Status</option>
          <option value="active">Active</option>
          <option value="inactive">Inactive</option>
          <option value="suspended">Suspended</option>
        </select>
      </div>
      <div class="col-md-3">
        <input type="date" class="form-control" id="dateFilter" placeholder="Filter by join date">
      </div>
      <div class="col-md-3">
        <input type="text" class="form-control" id="searchFilter" placeholder="Search by name or email">
      </div>
    </div>
  </div>

  <!-- Users Table -->
  <div class="admin-section">
    <div class="admin-table-container">
      <table class="table admin-table">
        <thead>
          <tr>
            <th>User ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Role</th>
            <th>Join Date</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% users.forEach(user => { %>
          <tr>
            <td>#<%= user.id.toString().padStart(4, '0') %></td>
            <td>
              <div class="user-info">
                <div class="user-avatar">
                  <%= user.name.charAt(0).toUpperCase() %>
                </div>
                <strong><%= user.name %></strong>
              </div>
            </td>
            <td><%= user.email %></td>
            <td>
              <span class="badge bg-<%= user.role === 'admin' ? 'danger' : user.role === 'staff' ? 'warning' : 'primary' %>">
                <%= user.role.charAt(0).toUpperCase() + user.role.slice(1) %>
              </span>
            </td>
            <td><%= new Date(user.joinDate).toLocaleDateString() %></td>
            <td>
              <span class="badge bg-<%= user.status === 'active' ? 'success' : user.status === 'inactive' ? 'secondary' : 'danger' %>">
                <%= user.status.charAt(0).toUpperCase() + user.status.slice(1) %>
              </span>
            </td>
            <td>
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-sm btn-outline-primary" onclick="viewUser(<%= user.id %>)">
                  <i class="fas fa-eye"></i>
                </button>
                <button type="button" class="btn btn-sm btn-outline-warning" onclick="editUser(<%= user.id %>)">
                  <i class="fas fa-edit"></i>
                </button>
                <div class="btn-group" role="group">
                  <button type="button" class="btn btn-sm btn-outline-success dropdown-toggle" data-bs-toggle="dropdown">
                    Update
                  </button>
                  <ul class="dropdown-menu">
                    <li><h6 class="dropdown-header">Change Role</h6></li>
                    <li>
                      <form method="POST" action="/admin/users/<%= user.id %>/update" class="d-inline">
                        <input type="hidden" name="role" value="customer">
                        <input type="hidden" name="status" value="<%= user.status %>">
                        <button type="submit" class="dropdown-item">Customer</button>
                      </form>
                    </li>
                    <li>
                      <form method="POST" action="/admin/users/<%= user.id %>/update" class="d-inline">
                        <input type="hidden" name="role" value="staff">
                        <input type="hidden" name="status" value="<%= user.status %>">
                        <button type="submit" class="dropdown-item">Staff</button>
                      </form>
                    </li>
                    <li>
                      <form method="POST" action="/admin/users/<%= user.id %>/update" class="d-inline">
                        <input type="hidden" name="role" value="admin">
                        <input type="hidden" name="status" value="<%= user.status %>">
                        <button type="submit" class="dropdown-item">Admin</button>
                      </form>
                    </li>
                    <li><hr class="dropdown-divider"></li>
                    <li><h6 class="dropdown-header">Change Status</h6></li>
                    <li>
                      <form method="POST" action="/admin/users/<%= user.id %>/update" class="d-inline">
                        <input type="hidden" name="role" value="<%= user.role %>">
                        <input type="hidden" name="status" value="active">
                        <button type="submit" class="dropdown-item">Activate</button>
                      </form>
                    </li>
                    <li>
                      <form method="POST" action="/admin/users/<%= user.id %>/update" class="d-inline">
                        <input type="hidden" name="role" value="<%= user.role %>">
                        <input type="hidden" name="status" value="suspended">
                        <button type="submit" class="dropdown-item text-danger">Suspend</button>
                      </form>
                    </li>
                  </ul>
                </div>
              </div>
            </td>
          </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
  </div>

  <!-- User Statistics -->
  <div class="admin-section">
    <h2>User Statistics</h2>
    <div class="row g-3">
      <div class="col-md-3">
        <div class="stat-card">
          <div class="stat-number">156</div>
          <div class="stat-label">Total Users</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stat-card">
          <div class="stat-number">142</div>
          <div class="stat-label">Active Users</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stat-card">
          <div class="stat-number">12</div>
          <div class="stat-label">New This Month</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stat-card">
          <div class="stat-number">3</div>
          <div class="stat-label">Admin Users</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <nav aria-label="Users pagination">
    <ul class="pagination justify-content-center">
      <li class="page-item disabled">
        <a class="page-link" href="#" tabindex="-1">Previous</a>
      </li>
      <li class="page-item active"><a class="page-link" href="#">1</a></li>
      <li class="page-item"><a class="page-link" href="#">2</a></li>
      <li class="page-item"><a class="page-link" href="#">3</a></li>
      <li class="page-item">
        <a class="page-link" href="#">Next</a>
      </li>
    </ul>
  </nav>
</div>

<!-- User Details Modal -->
<div class="modal fade" id="userModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">User Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="userModalBody">
        <!-- User details will be loaded here -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Add User Modal -->
<div class="modal fade" id="addUserModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add New User</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <form>
        <div class="modal-body">
          <div class="mb-3">
            <label for="userName" class="form-label">Full Name</label>
            <input type="text" class="form-control" id="userName" required>
          </div>
          <div class="mb-3">
            <label for="userEmail" class="form-label">Email</label>
            <input type="email" class="form-control" id="userEmail" required>
          </div>
          <div class="mb-3">
            <label for="userRole" class="form-label">Role</label>
            <select class="form-select" id="userRole" required>
              <option value="">Select Role</option>
              <option value="customer">Customer</option>
              <option value="staff">Staff</option>
              <option value="admin">Admin</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="userPassword" class="form-label">Temporary Password</label>
            <input type="password" class="form-control" id="userPassword" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">Add User</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
function viewUser(userId) {
  // Mock user details - replace with actual API call
  const userDetails = `
    <div class="user-details">
      <div class="row">
        <div class="col-md-4 text-center">
          <div class="user-avatar-large">JD</div>
          <h5>John Doe</h5>
          <span class="badge bg-primary">Customer</span>
        </div>
        <div class="col-md-8">
          <h6>Contact Information</h6>
          <p><strong>Email:</strong> john@example.com<br>
          <strong>Phone:</strong> +1 (555) 123-4567<br>
          <strong>Join Date:</strong> January 1, 2024</p>
          
          <h6>Account Status</h6>
          <p><strong>Status:</strong> <span class="badge bg-success">Active</span><br>
          <strong>Last Login:</strong> January 8, 2024<br>
          <strong>Total Orders:</strong> 15</p>
          
          <h6>Recent Activity</h6>
          <ul class="list-unstyled">
            <li>• Placed order #0012 - Jan 8, 2024</li>
            <li>• Registered for workshop - Jan 7, 2024</li>
            <li>• Updated profile - Jan 5, 2024</li>
          </ul>
        </div>
      </div>
    </div>
  `;
  
  document.getElementById('userModalBody').innerHTML = userDetails;
  new bootstrap.Modal(document.getElementById('userModal')).show();
}

function editUser(userId) {
  // Implement edit user functionality
  alert('Edit user functionality would be implemented here');
}

function showAddUserModal() {
  new bootstrap.Modal(document.getElementById('addUserModal')).show();
}
</script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<%- additionalJS %>
</body>
</html>