<!-- Cart Requests Management -->
<div class="admin-container">
  <div class="admin-header">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h1>Cart Requests</h1>
        <p class="text-muted">Manage customer orders and cart requests</p>
      </div>
      <a href="/admin" class="btn btn-outline-secondary">
        <i class="fas fa-arrow-left"></i> Back to Dashboard
      </a>
    </div>
  </div>

  <!-- Filter and Search -->
  <div class="admin-filters">
    <div class="row g-3">
      <div class="col-md-4">
        <select class="form-select" id="statusFilter">
          <option value="">All Status</option>
          <option value="pending">Pending</option>
          <option value="processing">Processing</option>
          <option value="completed">Completed</option>
          <option value="cancelled">Cancelled</option>
        </select>
      </div>
      <div class="col-md-4">
        <input type="date" class="form-control" id="dateFilter" placeholder="Filter by date">
      </div>
      <div class="col-md-4">
        <input type="text" class="form-control" id="searchFilter" placeholder="Search by customer name or email">
      </div>
    </div>
  </div>

  <!-- Cart Requests Table -->
  <div class="admin-section">
    <div class="admin-table-container">
      <table class="table admin-table">
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Customer</th>
            <th>Items</th>
            <th>Total</th>
            <th>Date</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% cartRequests.forEach(request => { %>
          <tr>
            <td>#<%= request.id.toString().padStart(4, '0') %></td>
            <td>
              <div class="customer-info">
                <strong><%= request.customerName %></strong>
                <br>
                <small class="text-muted"><%= request.email %></small>
              </div>
            </td>
            <td>
              <div class="items-list">
                <% request.items.forEach(item => { %>
                  <span class="badge bg-light text-dark me-1"><%= item %></span>
                <% }); %>
              </div>
            </td>
            <td class="fw-bold">$<%= request.total.toFixed(2) %></td>
            <td><%= new Date(request.date).toLocaleDateString() %></td>
            <td>
              <span class="badge bg-<%= request.status === 'completed' ? 'success' : request.status === 'pending' ? 'warning' : 'secondary' %>">
                <%= request.status.charAt(0).toUpperCase() + request.status.slice(1) %>
              </span>
            </td>
            <td>
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-sm btn-outline-primary" onclick="viewOrder(<%= request.id %>)">
                  <i class="fas fa-eye"></i>
                </button>
                <div class="btn-group" role="group">
                  <button type="button" class="btn btn-sm btn-outline-success dropdown-toggle" data-bs-toggle="dropdown">
                    Update
                  </button>
                  <ul class="dropdown-menu">
                    <li>
                      <form method="POST" action="/admin/cart-requests/<%= request.id %>/update" class="d-inline">
                        <input type="hidden" name="status" value="processing">
                        <button type="submit" class="dropdown-item">Mark as Processing</button>
                      </form>
                    </li>
                    <li>
                      <form method="POST" action="/admin/cart-requests/<%= request.id %>/update" class="d-inline">
                        <input type="hidden" name="status" value="completed">
                        <button type="submit" class="dropdown-item">Mark as Completed</button>
                      </form>
                    </li>
                    <li>
                      <form method="POST" action="/admin/cart-requests/<%= request.id %>/update" class="d-inline">
                        <input type="hidden" name="status" value="cancelled">
                        <button type="submit" class="dropdown-item text-danger">Cancel Order</button>
                      </form>
                    </li>
                  </ul>
                </div>
              </div>
            </td>
          </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Pagination -->
  <nav aria-label="Cart requests pagination">
    <ul class="pagination justify-content-center">
      <li class="page-item disabled">
        <a class="page-link" href="#" tabindex="-1">Previous</a>
      </li>
      <li class="page-item active"><a class="page-link" href="#">1</a></li>
      <li class="page-item"><a class="page-link" href="#">2</a></li>
      <li class="page-item"><a class="page-link" href="#">3</a></li>
      <li class="page-item">
        <a class="page-link" href="#">Next</a>
      </li>
    </ul>
  </nav>
</div>

<!-- Order Details Modal -->
<div class="modal fade" id="orderModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Order Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="orderModalBody">
        <!-- Order details will be loaded here -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script>
function viewOrder(orderId) {
  // Mock order details - replace with actual API call
  const orderDetails = `
    <div class="order-details">
      <h6>Order #${orderId.toString().padStart(4, '0')}</h6>
      <div class="row">
        <div class="col-md-6">
          <strong>Customer Information:</strong>
          <p>John Doe<br>john@example.com<br>+1 (555) 123-4567</p>
        </div>
        <div class="col-md-6">
          <strong>Order Information:</strong>
          <p>Date: January 8, 2024<br>Status: Pending<br>Total: $25.50</p>
        </div>
      </div>
      <strong>Items:</strong>
      <ul>
        <li>Robusta Blend - $15.00</li>
        <li>Espresso Shot - $8.50</li>
        <li>Tax - $2.00</li>
      </ul>
    </div>
  `;
  
  document.getElementById('orderModalBody').innerHTML = orderDetails;
  new bootstrap.Modal(document.getElementById('orderModal')).show();
}
</script>